<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="MailMessageQueueMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="MailMessageQueue" assembly="DMS.Model.dll" type="DMS.Model.MailMessageQueue" />
  </alias>
  <resultMaps>
    <resultMap id="MailMessageQueueResult" class="MailMessageQueue">
      <result property="Id" column="MMQ_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="QueueNo" column="MMQ_QueueNo" type="string" dbType="nvarchar"/>
      <result property="From" column="MMQ_From" type="string" dbType="nvarchar"/>
      <result property="To" column="MMQ_To" type="string" dbType="nvarchar"/>
      <result property="Subject" column="MMQ_Subject" type="string" dbType="nvarchar"/>
      <result property="Body" column="MMQ_Body" type="string" dbType="nvarchar"/>
      <result property="Status" column="MMQ_Status" type="string" dbType="nvarchar"/>
      <result property="CreateDate" column="MMQ_CreateDate" type="DateTime" dbType="datetime"/>
      <result property="SendDate" column="MMQ_SendDate" type="DateTime" dbType="datetime"/>
    </resultMap>
  </resultMaps>
  <statements>
    <select id="SelectMailMessageQueue" parameterClass="string" resultClass="MailMessageQueue">
      SELECT MMQ_ID AS Id,MMQ_QueueNo AS QueueNo,MMQ_From AS From,MMQ_To AS To,MMQ_Subject AS Subject,MMQ_Body AS Body,MMQ_Status AS Status,MMQ_CreateDate AS CreateDate,MMQ_SendDate AS SendDate
      FROM MailMessageQueue
      <dynamic prepend="WHERE">
        <isParameterPresent>
          MMQ_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterMailMessageQueue" parameterClass="MailMessageQueue" resultClass="MailMessageQueue">
      SELECT MMQ_ID AS Id,MMQ_QueueNo AS QueueNo,MMQ_From AS From,MMQ_To AS To,MMQ_Subject AS Subject,MMQ_Body AS Body,MMQ_Status AS Status,MMQ_CreateDate AS CreateDate,MMQ_SendDate AS SendDate
      FROM MailMessageQueue
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">MMQ_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="QueueNo">MMQ_QueueNo=#QueueNo#</isNotNull>
        <isNotNull prepend="AND" property="From">MMQ_From=#From#</isNotNull>
        <isNotNull prepend="AND" property="To">MMQ_To=#To#</isNotNull>
        <isNotNull prepend="AND" property="Subject">MMQ_Subject=#Subject#</isNotNull>
        <isNotNull prepend="AND" property="Body">MMQ_Body=#Body#</isNotNull>
        <isNotNull prepend="AND" property="Status">MMQ_Status=#Status#</isNotNull>
        <isNotNull prepend="AND" property="SendDate">MMQ_SendDate=#SendDate#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertMailMessageQueue" parameterClass="MailMessageQueue">
      INSERT INTO MailMessageQueue
      (MMQ_ID,MMQ_QueueNo,MMQ_From,MMQ_To,MMQ_Subject,MMQ_Body,MMQ_Status,MMQ_CreateDate,MMQ_SendDate)
      VALUES(#Id#,#QueueNo#,#From#,#To#,#Subject#,#Body#,#Status#,#CreateDate:DateTime:1/1/0001 12:00:00 AM#,#SendDate:DateTime:1/1/0001 12:00:00 AM#)
    </insert>
    <update id="UpdateMailMessageQueue" parameterClass="MailMessageQueue">
      UPDATE MailMessageQueue
      SET MMQ_ID=#Id#,MMQ_QueueNo=#QueueNo#,MMQ_From=#From#,MMQ_To=#To#,MMQ_Subject=#Subject#,MMQ_Body=#Body#,MMQ_Status=#Status#,MMQ_SendDate=#SendDate#
      WHERE MMQ_ID = #Id#
    </update>
    <delete id="DeleteMailMessageQueue" parameterClass="string">
      DELETE FROM MailMessageQueue
      WHERE MMQ_ID = #value#
    </delete>
    <!--added by bozhenfei on 20110309-->
    <select id="GetMailMessageQueue" parameterClass="string" resultClass="MailMessageQueue">
      SELECT MMQ_ID AS Id,MMQ_QueueNo AS QueueNo,MMQ_From AS [From],MMQ_To AS [To],MMQ_Subject AS Subject,MMQ_Body AS Body,MMQ_Status AS Status,MMQ_CreateDate AS CreateDate,MMQ_SendDate AS SendDate
      FROM MailMessageQueue WHERE MMQ_Status = 'Waiting' ORDER BY MMQ_QueueNo,MMQ_CreateDate
    </select>
    <!---->
  </statements>
</sqlMap>
