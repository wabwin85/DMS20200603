<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="PurchaseOrderInitMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="PurchaseOrderInit" assembly="DMS.Model.dll" type="DMS.Model.PurchaseOrderInit" />
  </alias>
  <resultMaps>
    <resultMap id="PurchaseOrderInitResult" class="PurchaseOrderInit">
      <result property="Id" column="POI_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="User" column="POI_USER" type="Guid" dbType="uniqueidentifier"/>
      <result property="UploadDate" column="POI_UploadDate" type="DateTime" dbType="datetime"/>
      <result property="LineNbr" column="POI_LineNbr" type="int" dbType="int"/>
      <result property="FileName" column="POI_FileName" type="string" dbType="nvarchar"/>
      <result property="ErrorFlag" column="POI_ErrorFlag" type="bool" dbType="bit"/>
      <result property="ErrorDescription" column="POI_ErrorDescription" type="string" dbType="nvarchar"/>
      <result property="OrderType" column="POI_OrderType" type="string" dbType="nvarchar"/>
      <result property="ArticleNumber" column="POI_ArticleNumber" type="string" dbType="nvarchar"/>
      <result property="RequiredQty" column="POI_RequiredQty" type="string" dbType="nvarchar"/>
      <result property="LotNumber" column="POI_LotNumber" type="string" dbType="nvarchar"/>
      <result property="DmaId" column="POI_DMA_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="CfnId" column="POI_CFN_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="BumId" column="POI_BUM_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="TerritoryCode" column="POI_TerritoryCode" type="string" dbType="nvarchar"/>
      <result property="Warehouse" column="POI_Warehouse" type="string" dbType="nvarchar"/>
      <result property="WhmId" column="POI_WHM_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="OrderTypeName" column="POI_OrderTypeName" type="string" dbType="nvarchar"/>
      <result property="OrderTypeErrMsg" column="POI_OrderType_ErrMsg" type="string" dbType="nvarchar"/>
      <result property="ArticleNumberErrMsg" column="POI_ArticleNumber_ErrMsg" type="string" dbType="nvarchar"/>
      <result property="RequiredQtyErrMsg" column="POI_RequiredQty_ErrMsg" type="string" dbType="nvarchar"/>
      <result property="LotNumberErrMsg" column="POI_LotNumber_ErrMsg" type="string" dbType="nvarchar"/>
      <result property="Amount" column="POI_Amount" type="string" dbType="nvarchar"/>
      <result property="AmountErrMsg" column="POI_Amount_ErrMsg" type="string" dbType="nvarchar"/>
      <result property="ProductLine" column="POI_ProductLine" type="string" dbType="nvarchar"/>
      <result property="ProductLineErrMsg" column="POI_ProductLine_ErrMsg" type="string" dbType="nvarchar"/>
    </resultMap>
  </resultMaps>
  <parameterMaps>
    <parameterMap id="PurchaseOrderInitParameterMap" class="System.Collections.Hashtable" >
      <parameter property="UserId" column="UserId" />
      <parameter property="ImportType" column="ImportType" />
      <parameter property="SubCompanyId" column="SubCompanyId" />
      <parameter property="BrandId" column="BrandId" />
      <parameter property="IsValid" column="IsValid" direction="Output" />
    </parameterMap>
  </parameterMaps>
  <statements>

    <select id="SelectPurchaseOrderInit" parameterClass="string" resultClass="PurchaseOrderInit">
      SELECT POI_ID AS Id,POI_USER AS User,POI_UploadDate AS UploadDate,POI_LineNbr AS LineNbr,POI_FileName AS FileName,POI_ErrorFlag AS ErrorFlag,POI_ErrorDescription AS ErrorDescription,POI_OrderType AS OrderType,POI_ArticleNumber AS ArticleNumber,POI_RequiredQty AS RequiredQty,POI_LotNumber AS LotNumber,POI_DMA_ID AS DmaId,POI_CFN_ID AS CfnId,POI_BUM_ID AS BumId,POI_TerritoryCode AS TerritoryCode,POI_Warehouse AS Warehouse,POI_WHM_ID AS WhmId,POI_OrderTypeName AS OrderTypeName,POI_OrderType_ErrMsg AS OrderTypeErrMsg,POI_ArticleNumber_ErrMsg AS ArticleNumberErrMsg,POI_RequiredQty_ErrMsg AS RequiredQtyErrMsg,POI_LotNumber_ErrMsg AS LotNumberErrMsg,POI_Amount AS Amount,POI_Amount_ErrMsg AS AmountErrMsg,POI_ProductLine AS ProductLine,POI_ProductLine_ErrMsg AS ProductLineErrMsg
      FROM PurchaseOrderInit
      <dynamic prepend="WHERE">
        <isParameterPresent>
          POI_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterPurchaseOrderInit" parameterClass="PurchaseOrderInit" resultClass="PurchaseOrderInit">
      SELECT POI_ID AS Id,POI_USER AS User,POI_UploadDate AS UploadDate,POI_LineNbr AS LineNbr,POI_FileName AS FileName,POI_ErrorFlag AS ErrorFlag,POI_ErrorDescription AS ErrorDescription,POI_OrderType AS OrderType,POI_ArticleNumber AS ArticleNumber,POI_RequiredQty AS RequiredQty,POI_LotNumber AS LotNumber,POI_DMA_ID AS DmaId,POI_CFN_ID AS CfnId,POI_BUM_ID AS BumId,POI_TerritoryCode AS TerritoryCode,POI_Warehouse AS Warehouse,POI_WHM_ID AS WhmId,POI_OrderTypeName AS OrderTypeName,POI_OrderType_ErrMsg AS OrderTypeErrMsg,POI_ArticleNumber_ErrMsg AS ArticleNumberErrMsg,POI_RequiredQty_ErrMsg AS RequiredQtyErrMsg,POI_LotNumber_ErrMsg AS LotNumberErrMsg,POI_Amount AS Amount,POI_Amount_ErrMsg AS AmountErrMsg,POI_ProductLine AS ProductLine,POI_ProductLine_ErrMsg AS ProductLineErrMsg
      FROM PurchaseOrderInit
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">POI_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="User">POI_USER=#User#</isNotNull>
        <isNotNull prepend="AND" property="UploadDate">POI_UploadDate=#UploadDate#</isNotNull>
        <isNotNull prepend="AND" property="LineNbr">POI_LineNbr=#LineNbr#</isNotNull>
        <isNotNull prepend="AND" property="FileName">POI_FileName=#FileName#</isNotNull>
        <isNotNull prepend="AND" property="ErrorFlag">POI_ErrorFlag=#ErrorFlag#</isNotNull>
        <isNotNull prepend="AND" property="ErrorDescription">POI_ErrorDescription=#ErrorDescription#</isNotNull>
        <isNotNull prepend="AND" property="OrderType">POI_OrderType=#OrderType#</isNotNull>
        <isNotNull prepend="AND" property="ArticleNumber">POI_ArticleNumber=#ArticleNumber#</isNotNull>
        <isNotNull prepend="AND" property="RequiredQty">POI_RequiredQty=#RequiredQty#</isNotNull>
        <isNotNull prepend="AND" property="LotNumber">POI_LotNumber=#LotNumber#</isNotNull>
        <isNotNull prepend="AND" property="DmaId">POI_DMA_ID=#DmaId#</isNotNull>
        <isNotNull prepend="AND" property="CfnId">POI_CFN_ID=#CfnId#</isNotNull>
        <isNotNull prepend="AND" property="BumId">POI_BUM_ID=#BumId#</isNotNull>
        <isNotNull prepend="AND" property="TerritoryCode">POI_TerritoryCode=#TerritoryCode#</isNotNull>
        <isNotNull prepend="AND" property="Warehouse">POI_Warehouse=#Warehouse#</isNotNull>
        <isNotNull prepend="AND" property="WhmId">POI_WHM_ID=#WhmId#</isNotNull>
        <isNotNull prepend="AND" property="OrderTypeName">POI_OrderTypeName=#OrderTypeName#</isNotNull>
        <isNotNull prepend="AND" property="OrderTypeErrMsg">POI_OrderType_ErrMsg=#OrderTypeErrMsg#</isNotNull>
        <isNotNull prepend="AND" property="ArticleNumberErrMsg">POI_ArticleNumber_ErrMsg=#ArticleNumberErrMsg#</isNotNull>
        <isNotNull prepend="AND" property="RequiredQtyErrMsg">POI_RequiredQty_ErrMsg=#RequiredQtyErrMsg#</isNotNull>
        <isNotNull prepend="AND" property="LotNumberErrMsg">POI_LotNumber_ErrMsg=#LotNumberErrMsg#</isNotNull>
        <isNotNull prepend="AND" property="Amount">POI_Amount=#Amount#</isNotNull>
        <isNotNull prepend="AND" property="AmountErrMsg">POI_Amount_ErrMsg=#AmountErrMsg#</isNotNull>
        <isNotNull prepend="AND" property="ProductLine">POI_ProductLine=#ProductLine#</isNotNull>
        <isNotNull prepend="AND" property="ProductLineErrMsg">POI_ProductLine_ErrMsg=#ProductLineErrMsg#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertPurchaseOrderInit" parameterClass="PurchaseOrderInit">
      INSERT INTO PurchaseOrderInit
      (POI_ID,POI_USER,POI_UploadDate,POI_LineNbr,POI_FileName,POI_ErrorFlag,POI_ErrorDescription,POI_OrderType,POI_ArticleNumber,POI_RequiredQty,POI_LotNumber,POI_DMA_ID,POI_CFN_ID,POI_BUM_ID,POI_TerritoryCode,POI_Warehouse,POI_WHM_ID,POI_OrderTypeName,POI_OrderType_ErrMsg,POI_ArticleNumber_ErrMsg,POI_RequiredQty_ErrMsg,POI_LotNumber_ErrMsg,POI_Amount,POI_Amount_ErrMsg,POI_ProductLine,POI_ProductLine_ErrMsg)
      VALUES(#Id#,#User#,#UploadDate:DateTime:1/1/0001 12:00:00 AM#,#LineNbr#,#FileName#,#ErrorFlag#,#ErrorDescription#,#OrderType#,#ArticleNumber#,#RequiredQty#,#LotNumber#,#DmaId#,#CfnId#,#BumId#,#TerritoryCode#,#Warehouse#,#WhmId#,#OrderTypeName#,#OrderTypeErrMsg#,#ArticleNumberErrMsg#,#RequiredQtyErrMsg#,#LotNumberErrMsg#,#Amount#,#AmountErrMsg#,#ProductLine#,#ProductLineErrMsg#)
    </insert>
    <update id="UpdatePurchaseOrderInit" parameterClass="PurchaseOrderInit">
      UPDATE PurchaseOrderInit
      SET POI_ID=#Id#,POI_USER=#User#,POI_UploadDate=#UploadDate#,POI_LineNbr=#LineNbr#,POI_FileName=#FileName#,POI_ErrorFlag=#ErrorFlag#,POI_ErrorDescription=#ErrorDescription#,POI_OrderType=#OrderType#,POI_ArticleNumber=#ArticleNumber#,POI_RequiredQty=#RequiredQty#,POI_LotNumber=#LotNumber#,POI_DMA_ID=#DmaId#,POI_CFN_ID=#CfnId#,POI_BUM_ID=#BumId#,POI_TerritoryCode=#TerritoryCode#,POI_Warehouse=#Warehouse#,POI_WHM_ID=#WhmId#,POI_OrderTypeName=#OrderTypeName#,POI_OrderType_ErrMsg=#OrderTypeErrMsg#,POI_ArticleNumber_ErrMsg=#ArticleNumberErrMsg#,POI_RequiredQty_ErrMsg=#RequiredQtyErrMsg#,POI_LotNumber_ErrMsg=#LotNumberErrMsg#,POI_Amount=#Amount#,POI_Amount_ErrMsg=#AmountErrMsg#,POI_ProductLine=#ProductLine#,POI_ProductLine_ErrMsg=#ProductLineErrMsg#
      WHERE POI_ID = #Id#
    </update>
    <delete id="DeletePurchaseOrderInit" parameterClass="string">
      DELETE FROM PurchaseOrderInit
      WHERE POI_ID = #value#
    </delete>
    <!--added by bozhenfei on 20110617-->
    <delete id="DeletePurchaseOrderInitByUser" parameterClass="string">
      DELETE FROM PurchaseOrderInit
      WHERE POI_USER = #value#
    </delete>
    <select id="SelectPurchaseOrderInitByHashtable" parameterClass="System.Collections.Hashtable" resultClass="PurchaseOrderInit">
      SELECT POI_ID AS Id,POI_USER AS [User],POI_UploadDate AS UploadDate,POI_LineNbr AS LineNbr,POI_FileName AS FileName,POI_ErrorFlag AS ErrorFlag,POI_ErrorDescription AS ErrorDescription,POI_ArticleNumber AS ArticleNumber,POI_RequiredQty AS RequiredQty,POI_LotNumber as LotNumber,POI_DMA_ID AS DmaId,POI_CFN_ID AS CfnId,POI_BUM_ID AS BumId,POI_TerritoryCode AS TerritoryCode,POI_OrderType AS OrderType,POI_OrderTypeName AS OrderTypeName,POI_OrderType_ErrMsg AS OrderTypeErrMsg,POI_ArticleNumber_ErrMsg AS ArticleNumberErrMsg,POI_RequiredQty_ErrMsg AS RequiredQtyErrMsg,POI_LotNumber_ErrMsg AS LotNumberErrMsg,POI_Amount AS Amount,POI_Amount_ErrMsg AS AmountErrMsg,POI_ProductLine AS ProductLine,POI_ProductLine_ErrMsg AS ProductLineErrMsg,POI_PointType AS PointType,POI_PointType_ErrMsg AS PointTypeErrMsg,
      ROW_NUMBER () OVER (ORDER BY POI_ErrorFlag DESC,POI_LineNbr ASC) AS row_number
      FROM PurchaseOrderInit
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">POI_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="User">POI_USER=#User#</isNotNull>
        <isNotNull prepend="AND" property="UploadDate">POI_UploadDate=#UploadDate#</isNotNull>
        <isNotNull prepend="AND" property="LineNbr">POI_LineNbr=#LineNbr#</isNotNull>
        <isNotNull prepend="AND" property="FileName">POI_FileName=#FileName#</isNotNull>
        <isNotNull prepend="AND" property="ErrorFlag">POI_ErrorFlag=#ErrorFlag#</isNotNull>
        <isNotNull prepend="AND" property="ErrorDescription">POI_ErrorDescription=#ErrorDescription#</isNotNull>
        <isNotNull prepend="AND" property="ArticleNumber">POI_ArticleNumber=#ArticleNumber#</isNotNull>
        <isNotNull prepend="AND" property="RequiredQty">POI_RequiredQty=#RequiredQty#</isNotNull>
        <isNotNull prepend="AND" property="DmaId">POI_DMA_ID=#DmaId#</isNotNull>
        <isNotNull prepend="AND" property="CfnId">POI_CFN_ID=#CfnId#</isNotNull>
        <isNotNull prepend="AND" property="BumId">POI_BUM_ID=#BumId#</isNotNull>
        <isNotNull prepend="AND" property="TerritoryCode">POI_TerritoryCode=#TerritoryCode#</isNotNull>        
        <isNotNull prepend="AND" property="POI_PointType">POI_PointType=#POI_PointType#</isNotNull>
      </dynamic>
    </select>
    <update id="UpdatePurchaseOrderInitForEdit" parameterClass="PurchaseOrderInit">
      UPDATE PurchaseOrderInit
      SET POI_OrderType = #OrderType#,POI_ArticleNumber=#ArticleNumber#,POI_RequiredQty=#RequiredQty#,POI_LotNumber=#LotNumber#,POI_Amount=#Amount#,POI_ProductLine=#ProductLine#,POI_PointType=#PointType#,
      POI_CFN_ID = null,POI_BUM_ID = null,POI_ErrorFlag = 0,
      POI_OrderType_ErrMsg=null,POI_ArticleNumber_ErrMsg=null,POI_RequiredQty_ErrMsg=null,POI_LotNumber_ErrMsg=null,POI_Amount_ErrMsg=null,POI_ProductLine_ErrMsg=null
      WHERE POI_ID = #Id#
    </update>
    <procedure id="GC_PurchaseOrderInit" parameterMap="PurchaseOrderInitParameterMap">
      dbo.GC_PurchaseOrderInit
    </procedure>
    <!--end-->
  </statements>
</sqlMap>
