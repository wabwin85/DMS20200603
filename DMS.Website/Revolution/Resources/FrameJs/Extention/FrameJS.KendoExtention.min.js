(function($) {
    $.fn.DmsApplyBasic = function(param1, param2) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsApplyBasic.methods[param1];
            if (func) {
                return func(this, param2);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsApplyBasic.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsApplyBasic.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            var html = "";
            html += '<div class="col-xs-12">';
            html += '  <div class="row" style="background-color: #f9f9f9;">';
            html += '     <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '         <div class="col-xs-4 col-label">单据编号</div>';
            html += '         <div class="col-xs-8 col-field">';
            html += '             <div id="' + controlId + '_ApplyNo_Control"></div>';
            html += "         </div>";
            html += "     </div>";
            html += '     <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '         <div class="col-xs-4 col-label">申请人</div>';
            html += '         <div class="col-xs-8 col-field">';
            html += '             <div id="' + controlId + '_ApplyUser_Control"></div>';
            html += "         </div>";
            html += "     </div>";
            html += '     <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '         <div class="col-xs-4 col-label">申请日期</div>';
            html += '         <div class="col-xs-8 col-field">';
            html += '             <div id="' + controlId + '_ApplyDate_Control"></div>';
            html += "         </div>";
            html += "     </div>";
            html += '     <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '         <div class="col-xs-4 col-label">状态</div>';
            html += '         <div class="col-xs-8 col-field">';
            html += '             <div id="' + controlId + '_Status_Control"></div>';
            html += "         </div>";
            html += "     </div>";
            html += "  </div>";
            html += "</div>";
            $(this).append(html);
            $("#" + controlId + "_ApplyDate_Control").html(setting.value.ApplyDate);
            $("#" + controlId + "_ApplyUser_Control").html(setting.value.ApplyUser);
            $("#" + controlId + "_ApplyNo_Control").html(setting.value.ApplyNo);
            $("#" + controlId + "_Status_Control").html(setting.value.Status);
        }
    };
    $.fn.DmsApplyBasic.defaults = $.extend({}, {
        type: "DmsApplyBasic",
        value: {
            ApplyDate: "",
            ApplyUser: "",
            ApplyNo: "",
            Status: ""
        }
    });
    $.fn.DmsApplyBasic.methods = {
        setValue: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("value", value);
            $("#" + controlId + "_ApplyDate_Control").html(value.ApplyDate);
            $("#" + controlId + "_ApplyUser_Control").html(value.ApplyUser);
            $("#" + controlId + "_ApplyNo_Control").html(value.ApplyNo);
            $("#" + controlId + "_Status_Control").html(value.Status);
        },
        getValue: function(my) {
            return $(my).data("value");
        }
    };
})(jQuery);

(function($) {
    $.fn.DmsConsignContract = function(param1, param2) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsConsignContract.methods[param1];
            if (func) {
                return func(this, param2);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsConsignContract.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsConsignContract.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            var html = "";
            html += '<div class="col-xs-12 dms-picker">';
            html += '    <div class="row">';
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group" style="font-size: 1.2em;">';
            html += '            <div class="col-xs-4 col-label"><i class="fa fa-fw fa-require"></i>寄售合同名称</div>';
            html += '            <div class="col-xs-8 col-field">';
            if (!setting.readonly) {
                html += '                <select id="' + controlId + '_Contract_Control" style="width: 100%;"></select>';
            } else {
                html += '                <div id="' + controlId + '_Contract_Control"></div>';
            }
            html += "            </div>";
            html += "        </div>";
            html += "    </div>";
            html += "</div>";
            html += '<div class="col-xs-12" style="background-color: #f9f9f9;">';
            html += '    <div class="row">';
            html += '        <div class="col-xs-12 col-group">';
            html += '            <div class="col-xs-4 col-label col-3to1-4and8-label">寄售合同名称</div>';
            html += '            <div class="col-xs-8 col-field col-3to1-4and8-field">';
            html += '                <div id="' + controlId + '_ContractName_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">寄售合同编号</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <div id="' + controlId + '_ContractNo_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">寄售天数</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <div id="' + controlId + '_ConsignDay_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">可延期次数</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <div id="' + controlId + '_DelayTimes_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">合同时间</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <div id="' + controlId + '_ContractDate_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">自动补货</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <input id="' + controlId + '_Kb_Control" type="checkbox"></input>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">控制总金额</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <input id="' + controlId + '_FixedMoney_Control" type="checkbox"></input>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">控制总数量</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <input id="' + controlId + '_FixedQuantity_Control" type="checkbox"></input>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-sm-6 col-md-4 col-group">';
            html += '            <div class="col-xs-4 col-label">有效期折扣规则</div>';
            html += '            <div class="col-xs-8 col-field">';
            html += '                <input id="' + controlId + '_UseDiscount_Control" type="checkbox"></input>';
            html += "            </div>";
            html += "        </div>";
            html += '        <div class="col-xs-12 col-group">';
            html += '            <div class="col-xs-4 col-label col-3to1-4and8-label">备注</div>';
            html += '            <div class="col-xs-8 col-field col-3to1-4and8-field">';
            html += '                <div id="' + controlId + '_Remark_Control"></div>';
            html += "            </div>";
            html += "        </div>";
            html += "    </div>";
            html += "</div>";
            $(this).append(html);
            $("#" + controlId + "_ContractName_Control").html(setting.value.ContractName);
            $("#" + controlId + "_ContractNo_Control").html(setting.value.ContractNo);
            $("#" + controlId + "_ConsignDay_Control").html(setting.value.ConsignDay);
            $("#" + controlId + "_DelayTimes_Control").html(setting.value.DelayTimes);
            $("#" + controlId + "_ContractDate_Control").html(setting.value.ContractDate);
            $("#" + controlId + "_Kb_Control").kendoMobileSwitch({
                onLabel: "是",
                offLabel: "否",
                enable: false,
                checked: setting.value.Kb
            });
            $("#" + controlId + "_FixedMoney_Control").kendoMobileSwitch({
                onLabel: "是",
                offLabel: "否",
                enable: false,
                checked: setting.value.FixedMoney
            });
            $("#" + controlId + "_FixedQuantity_Control").kendoMobileSwitch({
                onLabel: "是",
                offLabel: "否",
                enable: false,
                checked: setting.value.FixedQuantity
            });
            $("#" + controlId + "_UseDiscount_Control").kendoMobileSwitch({
                onLabel: "是",
                offLabel: "否",
                enable: false,
                checked: setting.value.UseDiscount
            });
            $("#" + controlId + "_Remark_Control").html(setting.value.Remark);
            if (!setting.readonly) {
                var optionLabel = "";
                if (setting.selectType == "all") {
                    optionLabel = "全部";
                } else if (setting.selectType == "select") {
                    optionLabel = "请选择";
                }
                $("#" + controlId + "_Contract_Control").kendoDropDownList({
                    height: 200,
                    dataTextField: setting.dataValue,
                    dataValueField: setting.dataKey,
                    dataSource: setting.dataSource,
                    optionLabel: optionLabel,
                    noDataTemplate: "",
                    value: setting.value.ContractId,
                    change: function(e) {
                        var contractId = this.value();
                        if (contractId != "") {
                            var data = {};
                            data.QryString = contractId;
                            FrameWindow.ShowLoading();
                            FrameUtil.SubmitAjax({
                                business: "Consign.ConsignCommon",
                                method: "QueryConsingContract",
                                url: Common.AppHandler,
                                data: data,
                                callback: function(model) {
                                    $("#" + controlId).data("value", model.RstResult);
                                    $("#" + controlId + "_ContractName_Control").html(model.RstResult.ContractName);
                                    $("#" + controlId + "_ContractNo_Control").html(model.RstResult.ContractNo);
                                    $("#" + controlId + "_ConsignDay_Control").html(model.RstResult.ConsignDay);
                                    $("#" + controlId + "_DelayTimes_Control").html(model.RstResult.DelayTimes);
                                    $("#" + controlId + "_ContractDate_Control").html(model.RstResult.ContractDate);
                                    $("#" + controlId + "_Kb_Control").data("kendoMobileSwitch").check(model.RstResult.Kb);
                                    $("#" + controlId + "_FixedMoney_Control").data("kendoMobileSwitch").check(model.RstResult.FixedMoney);
                                    $("#" + controlId + "_FixedQuantity_Control").data("kendoMobileSwitch").check(model.RstResult.FixedQuantity);
                                    $("#" + controlId + "_UseDiscount_Control").data("kendoMobileSwitch").check(model.RstResult.UseDiscount);
                                    $("#" + controlId + "_Remark_Control").html(model.Remark);
                                    setting.onChange.call(this);
                                    FrameWindow.HideLoading();
                                }
                            });
                        } else {
                            $("#" + controlId).DmsConsignContract("clear");
                            setting.onChange.call(this);
                        }
                    }
                });
            } else {
                $("#" + controlId + "_Remark_Control").html(setting.value.ContractName);
            }
        }
    };
    $.fn.DmsConsignContract.defaults = $.extend({}, {
        type: "DmsConsignContract",
        value: {
            ContractId: "",
            ContractName: "",
            ContractNo: "",
            ConsignDay: "",
            DelayTimes: "",
            ContractDate: "",
            Kb: false,
            FixedMoney: false,
            FixedQuantity: false,
            UseDiscount: false,
            Remark: ""
        },
        dataSource: [],
        dataKey: "",
        dataValue: "",
        selectType: "",
        readonly: false,
        onChange: function() {}
    });
    $.fn.DmsConsignContract.methods = {
        setDataSource: function(my, value) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Contract_Control").data("kendoDropDownList").setDataSource(value);
                $("#" + controlId).DmsConsignContract("clear");
            }
        },
        getValue: function(my) {
            return $(my).data("value");
        },
        clear: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                var value = $.fn.DmsConsignContract.defaults.value;
                $(my).data("value", value);
                $("#" + controlId + "_Contract_Control").data("kendoDropDownList").value("");
                $("#" + controlId + "_ContractName_Control").html("");
                $("#" + controlId + "_ContractNo_Control").html("");
                $("#" + controlId + "_ConsignDay_Control").html("");
                $("#" + controlId + "_DelayTimes_Control").html("");
                $("#" + controlId + "_ContractDate_Control").html("");
                $("#" + controlId + "_Kb_Control").data("kendoMobileSwitch").check(false);
                $("#" + controlId + "_FixedMoney_Control").data("kendoMobileSwitch").check(false);
                $("#" + controlId + "_FixedQuantity_Control").data("kendoMobileSwitch").check(false);
                $("#" + controlId + "_UseDiscount_Control").data("kendoMobileSwitch").check(false);
                $("#" + controlId + "_Remark_Control").html("");
            }
        }
    };
})(jQuery);

(function($) {
    $.fn.DmsDealerFilter = function(param1, param2, param3) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsDealerFilter.methods[param1];
            if (func) {
                return func(this, param2, param3);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsDealerFilter.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsDealerFilter.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            if (!setting.readonly) {
                var html = "";
                html += '<select id="' + controlId + '_Control" class="' + setting.className + '" style="' + setting.style + '"></select>';
                $(this).append(html);
                var optionLabel = "";
                if (setting.selectType == "all") {
                    optionLabel = "全部";
                } else if (setting.selectType == "select") {
                    optionLabel = "请选择";
                }
                var filtering;
                var opening;
                if (setting.serferFilter) {
                    opening = function() {
                        var message = setting.checkRequire.call(this, $("#" + controlId).data("parameters"));
                        if (message.length > 0) {
                            FrameWindow.ShowAlert({
                                target: "top",
                                alertType: "warning",
                                message: message
                            });
                        }
                    };
                    filtering = function(e) {
                        if (e.filter.value.length == 0) {
                            $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource([]);
                        } else {
                            var requestData = {};
                            requestData.DelegateBusiness = setting.delegateBusiness;
                            requestData.Parameters = $("#" + controlId).data("parameters");
                            requestData.QryString = e.filter.value;
                            FrameWindow.ShowLoading();
                            FrameUtil.SubmitAjax({
                                business: setting.business,
                                method: setting.method,
                                url: Common.AppHandler,
                                data: requestData,
                                callback: function(responseData) {
                                    $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(responseData.RstResult);
                                    FrameWindow.HideLoading();
                                }
                            });
                        }
                    };
                } else {
                    opening = function() {};
                    filtering = function(e) {};
                }
                if (setting.dataSource.length == 0 && setting.value.Key != "") {
                    var item = {};
                    eval("item." + setting.dataKey + " = '" + setting.value.Key + "'");
                    eval("item." + setting.dataValue + " = '" + setting.value.Value + "'");
                    setting.dataSource.push(item);
                }
                $("#" + controlId + "_Control").kendoDropDownList({
                    height: setting.height,
                    dataTextField: setting.dataValue,
                    dataValueField: setting.dataKey,
                    dataSource: setting.dataSource,
                    optionLabel: optionLabel,
                    noDataTemplate: "",
                    clearButton: true,
                    minLength: 1,
                    filter: setting.filter,
                    template: setting.template,
                    value: setting.value.Key,
                    text: setting.value.Value,
                    change: setting.onChange,
                    open: opening,
                    filtering: filtering
                });
            } else {
                var e = $.fn.FrameSpan(controlId + "_Control");
                $(this).append(e);
                $("#" + controlId + "_Control").html(setting.value.Value);
            }
        }
    };
    $.fn.DmsDealerFilter.defaults = $.extend({}, {
        type: "DmsDealerFilter",
        delegateBusiness: "",
        parameters: {},
        style: "width: 100%; ",
        className: "",
        business: 'Util.DealerFilter',
        method: 'Filter',
        height: 200,
        value: {
            Key: "",
            Value: ""
        },
        dataSource: [],
        dataKey: "",
        dataValue: "",
        template: "",
        selectType: "",
        filter: "none",
        readonly: false,
        serferFilter: false,
        checkRequire: function(parameters) {
            var message = [];
            return message;
        },
        onChange: function() {},
        onBlur: function() {},
        onFocus: function() {}
    });
    $.fn.DmsDealerFilter.methods = {
        setDataSource: function(my, value) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(value);
            }
        },
        setParameters: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("parameters", value);
        },
        setParameter: function(my, key, value) {
            var controlId = $(my).attr("id");
            var parameters = $(my).data("parameters");
            eval("parameters." + key + " = value");
            $(my).data("parameters", parameters);
        },
        setValue: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("value", value);
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").value(value.Key);
            } else {
                $("#" + controlId + "_Control").html(value.Value);
            }
        },
        getValue: function(my) {
            var controlId = $(my).attr("id");
            var value = {};
            if (!$(my).data("readonly")) {
                value.Key = $("#" + controlId + "_Control").data("kendoDropDownList").value();
                value.Value = $("#" + controlId + "_Control").data("kendoDropDownList").text();
            } else {
                value = $(my).data("value");
            }
            return value;
        },
        disable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable(false);
            }
        },
        enable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable();
            }
        },
        error: function(my) {},
        removeError: function(my) {}
    };
})(jQuery);

(function($) {
    $.fn.DmsEmployeeFilter = function(param1, param2, param3) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsEmployeeFilter.methods[param1];
            if (func) {
                return func(this, param2, param3);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsEmployeeFilter.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsEmployeeFilter.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            if (!setting.readonly) {
                var html = "";
                html += '<select id="' + controlId + '_Control" class="' + setting.className + '" style="' + setting.style + '"></select>';
                $(this).append(html);
                var optionLabel = "";
                if (setting.selectType == "all") {
                    optionLabel = "全部";
                } else if (setting.selectType == "select") {
                    optionLabel = "请选择";
                }
                var filtering;
                var opening;
                if (setting.serferFilter) {
                    opening = function() {
                        var message = setting.checkRequire.call(this, $("#" + controlId).data("parameters"));
                        if (message.length > 0) {
                            FrameWindow.ShowAlert({
                                target: "top",
                                alertType: "warning",
                                message: message
                            });
                        }
                    };
                    filtering = function(e) {
                        if (e.filter.value.length == 0) {
                            $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource([]);
                        } else {
                            var requestData = {};
                            requestData.DelegateBusiness = setting.delegateBusiness;
                            requestData.Parameters = $("#" + controlId).data("parameters");
                            requestData.QryString = e.filter.value;
                            FrameWindow.ShowLoading();
                            FrameUtil.SubmitAjax({
                                business: "Util.EmployeeFilter",
                                method: "Filter",
                                url: Common.AppHandler,
                                data: requestData,
                                callback: function(responseData) {
                                    $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(responseData.RstResult);
                                    FrameWindow.HideLoading();
                                }
                            });
                        }
                    };
                } else {
                    opening = function() {};
                    filtering = function(e) {};
                }
                if (setting.dataSource.length == 0 && setting.value.Key != "") {
                    var item = {};
                    eval("item." + setting.dataKey + " = '" + setting.value.Key + "'");
                    eval("item." + setting.dataValue + " = '" + setting.value.Value + "'");
                    setting.dataSource.push(item);
                }
                $("#" + controlId + "_Control").kendoDropDownList({
                    height: setting.height,
                    dataTextField: setting.dataValue,
                    dataValueField: setting.dataKey,
                    dataSource: setting.dataSource,
                    optionLabel: optionLabel,
                    noDataTemplate: "",
                    clearButton: true,
                    minLength: 1,
                    filter: setting.filter,
                    template: setting.template,
                    value: setting.value.Key,
                    text: setting.value.Value,
                    change: setting.onChange,
                    open: opening,
                    filtering: filtering
                });
            } else {
                var e = $.fn.FrameSpan(controlId + "_Control");
                $(this).append(e);
                $("#" + controlId + "_Control").html(setting.value.Value);
            }
        }
    };
    $.fn.DmsEmployeeFilter.defaults = $.extend({}, {
        type: "DmsEmployeeFilter",
        delegateBusiness: "",
        parameters: {},
        style: "width: 100%; ",
        className: "",
        height: 200,
        value: {
            Key: "",
            Value: ""
        },
        dataSource: [],
        dataKey: "",
        dataValue: "",
        template: "",
        selectType: "",
        filter: "none",
        readonly: false,
        serferFilter: false,
        checkRequire: function(parameters) {
            var message = [];
            return message;
        },
        onChange: function() {},
        onBlur: function() {},
        onFocus: function() {}
    });
    $.fn.DmsEmployeeFilter.methods = {
        setDataSource: function(my, value) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(value);
            }
        },
        setParameters: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("parameters", value);
        },
        setParameter: function(my, key, value) {
            var controlId = $(my).attr("id");
            var parameters = $(my).data("parameters");
            eval("parameters." + key + " = value");
            $(my).data("parameters", parameters);
        },
        setValue: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("value", value);
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").value(value.Key);
            } else {
                $("#" + controlId + "_Control").html(value.Value);
            }
        },
        getValue: function(my) {
            var controlId = $(my).attr("id");
            var value = {};
            if (!$(my).data("readonly")) {
                value.Key = $("#" + controlId + "_Control").data("kendoDropDownList").value();
                value.Value = $("#" + controlId + "_Control").data("kendoDropDownList").text();
            } else {
                value = $(my).data("value");
            }
            return value;
        },
        disable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable(false);
            }
        },
        enable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable();
            }
        },
        error: function(my) {},
        removeError: function(my) {}
    };
})(jQuery);

(function($) {
    $.fn.DmsHospitalFilter = function(param1, param2, param3) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsHospitalFilter.methods[param1];
            if (func) {
                return func(this, param2, param3);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsHospitalFilter.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsHospitalFilter.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            if (!setting.readonly) {
                var html = "";
                html += '<select id="' + controlId + '_Control" class="' + setting.className + '" style="' + setting.style + '"></select>';
                $(this).append(html);
                var optionLabel = "";
                if (setting.selectType == "all") {
                    optionLabel = "全部";
                } else if (setting.selectType == "select") {
                    optionLabel = "请选择";
                }
                var filtering;
                var opening;
                if (setting.serferFilter) {
                    opening = function() {
                        var message = setting.checkRequire.call(this, $("#" + controlId).data("parameters"));
                        if (message.length > 0) {
                            FrameWindow.ShowAlert({
                                target: "top",
                                alertType: "warning",
                                message: message
                            });
                        }
                    };
                    filtering = function(e) {
                        if (e.filter.value.length == 0) {
                            $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource([]);
                        } else {
                            var requestData = {};
                            requestData.DelegateBusiness = setting.delegateBusiness;
                            requestData.Parameters = $("#" + controlId).data("parameters");
                            requestData.QryString = e.filter.value;
                            FrameWindow.ShowLoading();
                            FrameUtil.SubmitAjax({
                                business: "Util.HospitalFilter",
                                method: "Filter",
                                url: Common.AppHandler,
                                data: requestData,
                                callback: function(responseData) {
                                    $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(responseData.RstResult);
                                    FrameWindow.HideLoading();
                                }
                            });
                        }
                    };
                } else {
                    opening = function() {};
                    filtering = function(e) {};
                }
                if (setting.dataSource.length == 0 && setting.value.Key != "") {
                    var item = {};
                    eval("item." + setting.dataKey + " = '" + setting.value.Key + "'");
                    eval("item." + setting.dataValue + " = '" + setting.value.Value + "'");
                    setting.dataSource.push(item);
                }
                $("#" + controlId + "_Control").kendoDropDownList({
                    height: setting.height,
                    dataTextField: setting.dataValue,
                    dataValueField: setting.dataKey,
                    dataSource: setting.dataSource,
                    optionLabel: optionLabel,
                    noDataTemplate: "",
                    clearButton: true,
                    minLength: 1,
                    filter: setting.filter,
                    template: setting.template,
                    value: setting.value.Key,
                    text: setting.value.Value,
                    change: setting.onChange,
                    open: opening,
                    filtering: filtering
                });
            } else {
                var e = $.fn.FrameSpan(controlId + "_Control");
                $(this).append(e);
                $("#" + controlId + "_Control").html(setting.value.Value);
            }
        }
    };
    $.fn.DmsHospitalFilter.defaults = $.extend({}, {
        type: "DmsHospitalFilter",
        delegateBusiness: "",
        parameters: {},
        style: "width: 100%; ",
        className: "",
        height: 200,
        value: {
            Key: "",
            Value: ""
        },
        dataSource: [],
        dataKey: "",
        dataValue: "",
        template: "",
        selectType: "",
        filter: "none",
        readonly: false,
        serferFilter: false,
        checkRequire: function(parameters) {
            var message = [];
            return message;
        },
        onChange: function() {},
        onBlur: function() {},
        onFocus: function() {}
    });
    $.fn.DmsHospitalFilter.methods = {
        setDataSource: function(my, value) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").setDataSource(value);
            }
        },
        setParameters: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("parameters", value);
        },
        setParameter: function(my, key, value) {
            var controlId = $(my).attr("id");
            var parameters = $(my).data("parameters");
            eval("parameters." + key + " = value");
            $(my).data("parameters", parameters);
        },
        setValue: function(my, value) {
            var controlId = $(my).attr("id");
            $(my).data("value", value);
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").value(value.Key);
            } else {
                $("#" + controlId + "_Control").html(value.Value);
            }
        },
        getValue: function(my) {
            var controlId = $(my).attr("id");
            var value = {};
            if (!$(my).data("readonly")) {
                value.Key = $("#" + controlId + "_Control").data("kendoDropDownList").value();
                value.Value = $("#" + controlId + "_Control").data("kendoDropDownList").text();
            } else {
                value = $(my).data("value");
            }
            return value;
        },
        disable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable(false);
            }
        },
        enable: function(my) {
            var controlId = $(my).attr("id");
            if (!$(my).data("readonly")) {
                $("#" + controlId + "_Control").data("kendoDropDownList").enable();
            }
        },
        error: function(my) {},
        removeError: function(my) {}
    };
})(jQuery);

(function($) {
    $.fn.DmsOperationLog = function(param1, param2) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsOperationLog.methods[param1];
            if (func) {
                return func(this, param2);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsOperationLog.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsHospitalFilter.defaults.value;
            }
            $(this).data(setting);
            $("#" + controlId).empty();
            if (setting.dataSource.length > 0) {
                var html = "";
                html += '<div class="box box-primary" style="margin-bottom: 5px;">';
                html += '\t<div class="box-header with-border">';
                html += '\t    <h3 class="box-title"><i class="fa fa-fw fa-navicon"></i>&nbsp;操作记录</span>';
                html += "\t</div>";
                html += '\t<div class="box-body" style="padding: 0px;">';
                html += '\t    <div class="col-xs-12">';
                html += '\t        <div class="row">';
                html += '\t            <div id="' + controlId + '_Control" class="k-grid-page-all frame-grid"></div>';
                html += "\t        </div>";
                html += "\t    </div>";
                html += "\t</div>";
                html += "</div>";
                $("#" + controlId).append(html);
                $("#" + controlId + "_Control").kendoGrid({
                    dataSource: setting.dataSource,
                    columns: [ {
                        title: "序号",
                        width: "50px",
                        headerAttributes: {
                            class: "text-center text-bold",
                            title: "序号"
                        },
                        template: "<span class='row-number'></span>",
                        attributes: {
                            class: "text-right"
                        }
                    }, {
                        field: "OperUserId",
                        title: "操作人账号",
                        width: "200px",
                        headerAttributes: {
                            class: "center bold",
                            title: "操作人账号"
                        }
                    }, {
                        field: "OperUser",
                        title: "操作人姓名",
                        width: "200px",
                        headerAttributes: {
                            class: "center bold",
                            title: "操作人姓名"
                        }
                    }, {
                        field: "OperTypeName",
                        title: "操作内容",
                        width: "150px",
                        headerAttributes: {
                            class: "center bold",
                            title: "操作内容"
                        }
                    }, {
                        field: "OperDate",
                        title: "操作时间",
                        width: "150px",
                        headerAttributes: {
                            class: "center bold",
                            title: "操作时间"
                        }
                    }, {
                        field: "OperNote",
                        title: "备注信息",
                        width: "auto",
                        headerAttributes: {
                            class: "center bold",
                            title: "备注信息"
                        }
                    } ],
                    noRecords: true,
                    messages: {
                        noRecords: "没有符合条件的记录"
                    },
                    dataBound: function(e) {
                        var grid = e.sender;
                        var rows = this.items();
                        $(rows).each(function() {
                            var index = $(this).index() + 1;
                            var rowLabel = $(this).find(".row-number");
                            $(rowLabel).html(index);
                        });
                    }
                });
            }
        }
    };
    $.fn.DmsOperationLog.defaults = $.extend({}, {
        type: "DmsOperationLog",
        dataSource: []
    });
    $.fn.DmsOperationLog.methods = {
        setDatasource: function(my, value) {
            var controlId = $(my).attr("id");
            $("#" + controlId + "_Control").data("kendoGrid").setOptions({
                dataSource: value
            });
        }
    };
})(jQuery);

(function($) {
    $.fn.DmsDataImport = function(param1, param2) {
        if (typeof $(this) == "undefined" || $(this).length == 0) {
            return;
        }
        var controlId = $(this).attr("id");
        if (typeof param1 == "string") {
            var func = $.fn.DmsDataImport.methods[param1];
            if (func) {
                return func(this, param2);
            } else {
                console.log("error: none method");
                return "";
            }
        } else {
            var setting = $.extend({}, $.fn.DmsDataImport.defaults, param1);
            if (!setting.value) {
                setting.value = $.fn.DmsDataImport.defaults.value;
            }
            $(this).data(setting);
            $(this).empty();
            var html = "";
            if (!setting.readOnly) {
                html += '<div style="display: none;"><input type="file" id="' + controlId + '_BtnUpload" /></div>';
                html += '<a id="' + controlId + '_BtnFile" />\n';
                html += '<a id="' + controlId + '_BtnShowError" />\n';
                if (setting.template) {
                    html += '<a id="' + controlId + '_BtnDownload" />\n';
                }
            } else {
                html += '<a id="' + controlId + '_BtnShowDetail" />\n';
            }
            $("#" + controlId).append(html);
            if (!setting.readOnly) {
                var urlUpload = Common.AppVirtualPath + "Revolution/Pages/Handler/DataImportUploadHanler.ashx";
                urlUpload = Common.UpdateUrlParams(urlUpload, "KeepFile", setting.keepFile);
                urlUpload = Common.UpdateUrlParams(urlUpload, "DelegateBusiness", setting.delegateBusiness);
                var urlError = Common.AppVirtualPath + "Revolution/Pages/Util/DataImport/DataImportErrorList.aspx";
                urlError = Common.UpdateUrlParams(urlError, "DelegateBusiness", setting.delegateBusiness);
                var urlTemplate = Common.AppVirtualPath + "Revolution/Pages/Util/DataImport/DataImportTemplate.aspx";
                $("#" + controlId + "_BtnUpload").kendoUpload({
                    async: {
                        saveUrl: urlUpload,
                        autoUpload: true
                    },
                    select: function(e) {
                        $("#" + controlId + "_BtnUpload").data("kendoUpload").setOptions({
                            async: {
                                saveUrl: setting.appendUploadParam.call(this, urlUpload),
                                autoUpload: true
                            }
                        });
                        FrameWindow.ShowLoading();
                    },
                    multiple: false,
                    success: function(e) {
                        $("#" + controlId).data("uploaded", true);
                        if (e.response.IsSuccess) {
                            if (!e.response.CheckResult) {
                                $("#" + controlId).data("success", false);
                                FrameWindow.ShowAlert({
                                    target: "top",
                                    alertType: "warning",
                                    message: "Excel文件中数据有误，请查看错误信息",
                                    callback: function() {
                                        $("#" + controlId + "_BtnShowError").show();
                                    }
                                });
                            } else {
                                $("#" + controlId).data("success", true);
                                FrameWindow.ShowAlert({
                                    target: "top",
                                    alertType: "info",
                                    message: "数据导入成功",
                                    callback: function() {
                                        $("#" + controlId + "_BtnShowError").hide();
                                    }
                                });
                            }
                            FrameWindow.HideLoading();
                            setting.onSuccess.call(this, e.response);
                        } else {
                            FrameWindow.ShowAlert({
                                target: "top",
                                alertType: "error",
                                message: e.response.ExecuteMessage
                            });
                            FrameWindow.HideLoading();
                        }
                    },
                    error: function(e) {
                        FrameWindow.ShowAlert({
                            target: "top",
                            alertType: "error",
                            message: "上传文件出错！"
                        });
                        FrameWindow.HideLoading();
                    }
                });
                $("#" + controlId + "_BtnFile").FrameButton({
                    text: setting.fileText,
                    icon: "folder-open",
                    onClick: function() {
                        var message = setting.checkUpload.call(this);
                        if (message.length > 0) {
                            FrameWindow.ShowAlert({
                                target: "top",
                                alertType: "warning",
                                message: message
                            });
                        } else {
                            $("#" + controlId + "_BtnUpload").click();
                        }
                    }
                });
                $("#" + controlId + "_BtnShowError").FrameButton({
                    text: "错误信息",
                    icon: "exclamation-triangle",
                    style: {
                        display: "none",
                        "margin-left": "5px"
                    },
                    className: "btn-danger",
                    onClick: function() {
                        urlError = setting.appendErrorParam.call(this, urlError);
                        FrameWindow.OpenWindow({
                            target: "top",
                            title: "错误信息",
                            url: urlError,
                            width: $(window).width() * .7,
                            height: $(window).height() * .9,
                            actions: [ "Close" ]
                        });
                    }
                });
                if (setting.template) {
                    $("#" + controlId + "_BtnDownload").FrameButton({
                        text: "导入模板下载",
                        icon: "download",
                        style: {
                            "margin-left": "5px"
                        },
                        onClick: function() {
                            urlTemplate = setting.appendTemplateParam.call(this, urlTemplate);
                            FrameUtil.StartDownload({
                                url: urlTemplate,
                                cookie: setting.cookie,
                                business: setting.delegateBusiness
                            });
                        }
                    });
                }
            } else {
                var urlDetail = Common.AppVirtualPath + "Revolution/Pages/Util/DataImport/FileCheckDetailList.aspx";
                urlDetail = $.updateUrlParams(urlDetail, "DelegateBusiness", setting.delegateBusiness);
                urlDetail = $.updateUrlParams(urlDetail, "InstanceId", setting.instanceId);
                $("#" + controlId + "_BtnShowDetail").FrameButton({
                    text: "导入信息",
                    icon: "server",
                    onClick: function() {
                        openWindow({
                            target: "top",
                            title: "导入信息",
                            url: urlDetail,
                            width: $(window).width() * .7,
                            height: $(window).height() * .9,
                            actions: [ "Close" ]
                        });
                    }
                });
            }
        }
    };
    $.fn.DmsDataImport.defaults = $.extend({}, {
        type: "DmsDataImport",
        delegateBusiness: "",
        instanceId: "",
        keepFile: false,
        cookie: "",
        readOnly: false,
        template: false,
        success: true,
        uploaded: false,
        fileText: "上传",
        appendUploadParam: function(url) {
            return url;
        },
        appendTemplateParam: function(url) {
            return url;
        },
        appendErrorParam: function(url) {
            return url;
        },
        onSuccess: function(e) {},
        checkUpload: function() {
            return [];
        }
    });
    $.fn.DmsDataImport.methods = {
        IsSuccess: function(my, value) {
            var controlId = $(my).attr("id");
            return $("#" + controlId).data("success");
        },
        IsUploaded: function(my, value) {
            var controlId = $(my).attr("id");
            return $("#" + controlId).data("uploaded");
        },
        ShowErrorInfo: function(my, value) {
            var controlId = $(my).attr("id");
            $("#" + controlId).data("success", false);
            $("#" + controlId + "_BtnShowError").show();
        },
        HideErrorInfo: function(my, value) {
            var controlId = $(my).attr("id");
            $("#" + controlId).data("success", true);
            $("#" + controlId + "_BtnShowError").hide();
        }
    };
})(jQuery);