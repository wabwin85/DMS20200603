<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="DealerShipToMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="DealerShipTo" assembly="DMS.Model.dll" type="DMS.Model.DealerShipTo" />
  </alias>
  <resultMaps>
    <resultMap id="DealerShipToResult" class="DealerShipTo">
      <result property="Id" column="DST_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="DealerUserId" column="DST_Dealer_User_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="DealerDmaId" column="DST_Dealer_DMA_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="ContactPerson" column="DST_ContactPerson" type="string" dbType="nvarchar"/>
      <result property="Contact" column="DST_Contact" type="string" dbType="nvarchar"/>
      <result property="ContactMobile" column="DST_ContactMobile" type="string" dbType="nvarchar"/>
      <result property="Email" column="DST_Email" type="string" dbType="nvarchar"/>
      <result property="Consignee" column="DST_Consignee" type="string" dbType="nvarchar"/>
      <result property="ShipToAddress" column="DST_ShipToAddress" type="string" dbType="nvarchar"/>
      <result property="ConsigneePhone" column="DST_ConsigneePhone" type="string" dbType="nvarchar"/>
      <result property="Receivesms" column="DST_ReceiveSMS" type="bool" dbType="bit"/>
      <result property="ReceiveEmail" column="DST_ReceiveEmail" type="bool" dbType="bit"/>
      <result property="ReceiveOrder" column="DST_ReceiveOrder" type="bool" dbType="bit"/>
      <result property="IsDefault" column="DST_IsDefault" type="bool" dbType="bit"/>
    </resultMap>
  </resultMaps>
  <statements>

    <select id="SelectDealerShipTo" parameterClass="string" resultClass="DealerShipTo">
      SELECT DST_ID AS Id,DST_Dealer_User_ID AS DealerUserId,DST_Dealer_DMA_ID AS DealerDmaId,DST_ContactPerson AS ContactPerson,DST_Contact AS Contact,DST_ContactMobile AS ContactMobile,DST_Email AS Email,DST_Consignee AS Consignee,DST_ShipToAddress AS ShipToAddress,DST_ConsigneePhone AS ConsigneePhone,DST_ReceiveSMS AS Receivesms,DST_ReceiveEmail AS ReceiveEmail,DST_ReceiveOrder AS ReceiveOrder,DST_IsDefault AS IsDefault
      FROM DealerShipTo
      <dynamic prepend="WHERE">
        <isParameterPresent>
          DST_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterDealerShipTo" parameterClass="DealerShipTo" resultClass="DealerShipTo">
      SELECT DST_ID AS Id,DST_Dealer_User_ID AS DealerUserId,DST_Dealer_DMA_ID AS DealerDmaId,DST_ContactPerson AS ContactPerson,DST_Contact AS Contact,DST_ContactMobile AS ContactMobile,DST_Email AS Email,DST_Consignee AS Consignee,DST_ShipToAddress AS ShipToAddress,DST_ConsigneePhone AS ConsigneePhone,DST_ReceiveSMS AS Receivesms,DST_ReceiveEmail AS ReceiveEmail,DST_ReceiveOrder AS ReceiveOrder,DST_IsDefault AS IsDefault
      FROM DealerShipTo
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">DST_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="DealerUserId">DST_Dealer_User_ID=#DealerUserId#</isNotNull>
        <isNotNull prepend="AND" property="DealerDmaId">DST_Dealer_DMA_ID=#DealerDmaId#</isNotNull>
        <isNotNull prepend="AND" property="ContactPerson">DST_ContactPerson=#ContactPerson#</isNotNull>
        <isNotNull prepend="AND" property="Contact">DST_Contact=#Contact#</isNotNull>
        <isNotNull prepend="AND" property="ContactMobile">DST_ContactMobile=#ContactMobile#</isNotNull>
        <isNotNull prepend="AND" property="Email">DST_Email=#Email#</isNotNull>
        <isNotNull prepend="AND" property="Consignee">DST_Consignee=#Consignee#</isNotNull>
        <isNotNull prepend="AND" property="ShipToAddress">DST_ShipToAddress=#ShipToAddress#</isNotNull>
        <isNotNull prepend="AND" property="ConsigneePhone">DST_ConsigneePhone=#ConsigneePhone#</isNotNull>
        <isNotNull prepend="AND" property="Receivesms">DST_ReceiveSMS=#Receivesms#</isNotNull>
        <isNotNull prepend="AND" property="ReceiveEmail">DST_ReceiveEmail=#ReceiveEmail#</isNotNull>
        <isNotNull prepend="AND" property="ReceiveOrder">DST_ReceiveOrder=#ReceiveOrder#</isNotNull>
        <isNotNull prepend="AND" property="IsDefault">DST_IsDefault=#IsDefault#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertDealerShipTo" parameterClass="DealerShipTo">
      INSERT INTO DealerShipTo
      (DST_ID,DST_Dealer_User_ID,DST_Dealer_DMA_ID,DST_ContactPerson,DST_Contact,DST_ContactMobile,DST_Email,DST_Consignee,DST_ShipToAddress,DST_ConsigneePhone,DST_ReceiveSMS,DST_ReceiveEmail,DST_ReceiveOrder,DST_IsDefault)
      VALUES(#Id#,#DealerUserId#,#DealerDmaId#,#ContactPerson#,#Contact#,#ContactMobile#,#Email#,#Consignee#,#ShipToAddress#,#ConsigneePhone#,#Receivesms#,#ReceiveEmail#,#ReceiveOrder#,#IsDefault#)
    </insert>
    <update id="UpdateDealerShipTo" parameterClass="DealerShipTo">
      UPDATE DealerShipTo
      SET DST_ID=#Id#,DST_Dealer_User_ID=#DealerUserId#,DST_Dealer_DMA_ID=#DealerDmaId#,DST_ContactPerson=#ContactPerson#,DST_Contact=#Contact#,DST_ContactMobile=#ContactMobile#,DST_Email=#Email#,DST_Consignee=#Consignee#,DST_ShipToAddress=#ShipToAddress#,DST_ConsigneePhone=#ConsigneePhone#,DST_ReceiveSMS=#Receivesms#,DST_ReceiveEmail=#ReceiveEmail#,DST_ReceiveOrder = #ReceiveOrder#,DST_IsDefault=#IsDefault#
      WHERE DST_ID = #Id#
    </update>
    <delete id="DeleteDealerShipTo" parameterClass="string">
      DELETE FROM DealerShipTo
      WHERE DST_ID = #value#
    </delete>
    <!--added by bozhenfei on 20110216-->
    <select id="QueryDealerShipToByFilter" parameterClass="System.Collections.Hashtable" resultClass="DealerShipTo">
      SELECT DST_ID AS Id,DST_Dealer_User_ID AS DealerUserId,DST_Dealer_DMA_ID AS DealerDmaId,DST_ContactPerson AS ContactPerson,DST_Contact AS Contact,DST_ContactMobile AS ContactMobile,DST_Email AS Email,DST_Consignee AS Consignee,DST_ShipToAddress AS ShipToAddress,DST_ConsigneePhone AS ConsigneePhone,DST_ReceiveSMS AS Receivesms,DST_ReceiveEmail AS ReceiveEmail,DST_ReceiveOrder AS ReceiveOrder,DST_IsDefault AS IsDefault
      FROM DealerShipTo
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">DST_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="DealerUserId">DST_Dealer_User_ID=#DealerUserId#</isNotNull>
        <isNotNull prepend="AND" property="DealerDmaId">DST_Dealer_DMA_ID=#DealerDmaId#</isNotNull>
        <isNotNull prepend="AND" property="ContactPerson">DST_ContactPerson=#ContactPerson#</isNotNull>
        <isNotNull prepend="AND" property="Contact">DST_Contact=#Contact#</isNotNull>
        <isNotNull prepend="AND" property="ContactMobile">DST_ContactMobile=#ContactMobile#</isNotNull>
        <isNotNull prepend="AND" property="Email">DST_Email=#Email#</isNotNull>
        <isNotNull prepend="AND" property="Consignee">DST_Consignee=#Consignee#</isNotNull>
        <isNotNull prepend="AND" property="ShipToAddress">DST_ShipToAddress=#ShipToAddress#</isNotNull>
        <isNotNull prepend="AND" property="ConsigneePhone">DST_ConsigneePhone=#ConsigneePhone#</isNotNull>
        <isNotNull prepend="AND" property="Receivesms">DST_ReceiveSMS=#Receivesms#</isNotNull>
        <isNotNull prepend="AND" property="ReceiveEmail">DST_ReceiveEmail=#ReceiveEmail#</isNotNull>
        <isNotNull prepend="AND" property="ReceiveOrder">DST_ReceiveOrder=#ReceiveOrder#</isNotNull>
        <isNotNull prepend="AND" property="IsDefault">DST_IsDefault=#IsDefault#</isNotNull>
      </dynamic>
    </select>
    <update id="UpdateDealerShipToById" parameterClass="DealerShipTo">
      UPDATE DealerShipTo
      SET DST_ContactPerson=#ContactPerson#,DST_Contact=#Contact#,DST_ContactMobile=#ContactMobile#,DST_Consignee=#Consignee#,DST_ShipToAddress=#ShipToAddress#,DST_ConsigneePhone=#ConsigneePhone#,DST_ReceiveSMS=#Receivesms#,DST_ReceiveEmail=#ReceiveEmail#,DST_ReceiveOrder = #ReceiveOrder#,DST_Email=#Email#
      WHERE DST_Dealer_User_ID=#DealerUserId#
    </update>
    <!--end-->

    <select id="QueryParentDealerEmailAddress" parameterClass="System.Collections.Hashtable" resultClass="DealerShipTo">
      SELECT top 1 DST_ID AS Id,DST_Dealer_User_ID AS DealerUserId,DST_Dealer_DMA_ID AS DealerDmaId,DST_ContactPerson AS ContactPerson,DST_Contact AS Contact,DST_ContactMobile AS ContactMobile,DST_Email AS Email,DST_Consignee AS Consignee,DST_ShipToAddress AS ShipToAddress,DST_ConsigneePhone AS ConsigneePhone,DST_ReceiveSMS AS Receivesms,DST_ReceiveEmail AS ReceiveEmail,DST_ReceiveOrder AS ReceiveOrder,DST_IsDefault AS IsDefault
      FROM DealerShipTo t2
      WHERE     t2.DST_IsDefault = 1
      AND t2.DST_Dealer_DMA_ID IN
      (SELECT DMA_parent_DMA_ID
      FROM DealerMaster(nolock)
      WHERE DMA_ID = #DmaId#)
    </select>
    <select id="QueryDealerEmailAddress" parameterClass="System.Collections.Hashtable" resultClass="DealerShipTo">
      SELECT top 1 DST_ID AS Id,DST_Dealer_User_ID AS DealerUserId,DST_Dealer_DMA_ID AS DealerDmaId,DST_ContactPerson AS ContactPerson,DST_Contact AS Contact,DST_ContactMobile AS ContactMobile,DST_Email AS Email,DST_Consignee AS Consignee,DST_ShipToAddress AS ShipToAddress,DST_ConsigneePhone AS ConsigneePhone,DST_ReceiveSMS AS Receivesms,DST_ReceiveEmail AS ReceiveEmail,DST_ReceiveOrder AS ReceiveOrder,DST_IsDefault AS IsDefault
      FROM DealerShipTo t2
      WHERE     t2.DST_IsDefault = 1
      AND t2.DST_Dealer_DMA_ID = #DmaId#
    </select>
  </statements>
</sqlMap>
