<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="SapWarehouseAddressMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="SapWarehouseAddress" assembly="DMS.Model.dll" type="DMS.Model.SapWarehouseAddress" />
  </alias>
  <resultMaps>
    <resultMap id="SapWarehouseAddressResult" class="SapWarehouseAddress">
      <result property="Id" column="SWA_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="DmaId" column="SWA_DMA_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="Name" column="SWA_Name" type="string" dbType="nvarchar"/>
      <result property="WhCode" column="SWA_WH_Code" type="string" dbType="nvarchar"/>
      <result property="WhType" column="SWA_WH_Type" type="string" dbType="nvarchar"/>
      <result property="WhAddress" column="SWA_WH_Address" type="string" dbType="nvarchar"/>
      <result property="ActiveFlag" column="SWA_ActiveFlag" type="bool" dbType="bit"/>
      <result property="CreateDate" column="SWA_CreateDate" type="DateTime" dbType="datetime"/>
      <result property="UpdateDate" column="SWA_UpdateDate" type="DateTime" dbType="datetime"/>
    </resultMap>
  </resultMaps>
  <statements>

    <select id="SelectSapWarehouseAddress" parameterClass="string" resultClass="SapWarehouseAddress">
      SELECT SWA_ID AS Id,SWA_DMA_ID AS DmaId,SWA_Name AS Name,SWA_WH_Code AS WhCode,SWA_WH_Type AS WhType,SWA_WH_Address AS WhAddress,SWA_ActiveFlag AS ActiveFlag,SWA_CreateDate AS CreateDate,SWA_UpdateDate AS UpdateDate
      FROM SAPWarehouseAddress
      <dynamic prepend="WHERE">
        <isParameterPresent>
          SWA_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectSapWarehouseAddressByCode" parameterClass="string" resultClass="SapWarehouseAddress">
      SELECT TOP 1 SWA_ID AS Id,SWA_DMA_ID AS DmaId,SWA_Name AS Name,SWA_WH_Code AS WhCode,SWA_WH_Type AS WhType,SWA_WH_Address AS WhAddress,SWA_ActiveFlag AS ActiveFlag,SWA_CreateDate AS CreateDate,SWA_UpdateDate AS UpdateDate
      FROM SAPWarehouseAddress
      <dynamic prepend="WHERE">
        <isParameterPresent>
          SWA_WH_Code = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterSapWarehouseAddress" parameterClass="SapWarehouseAddress" resultClass="SapWarehouseAddress">
      SELECT SWA_ID AS Id,SWA_DMA_ID AS DmaId,SWA_Name AS Name,SWA_WH_Code AS WhCode,SWA_WH_Type AS WhType,SWA_WH_Address AS WhAddress,SWA_ActiveFlag AS ActiveFlag,SWA_CreateDate AS CreateDate,SWA_UpdateDate AS UpdateDate
      FROM SAPWarehouseAddress
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">SWA_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="DmaId">SWA_DMA_ID=#DmaId#</isNotNull>
        <isNotNull prepend="AND" property="Name">SWA_Name=#Name#</isNotNull>
        <isNotNull prepend="AND" property="WhCode">SWA_WH_Code=#WhCode#</isNotNull>
        <isNotNull prepend="AND" property="WhType">SWA_WH_Type=#WhType#</isNotNull>
        <isNotNull prepend="AND" property="WhAddress">SWA_WH_Address=#WhAddress#</isNotNull>
        <isNotNull prepend="AND" property="ActiveFlag">SWA_ActiveFlag=#ActiveFlag#</isNotNull>
        <isNotNull prepend="AND" property="UpdateDate">SWA_UpdateDate=#UpdateDate#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertSapWarehouseAddress" parameterClass="SapWarehouseAddress">
      INSERT INTO SAPWarehouseAddress
      (SWA_ID,SWA_DMA_ID,SWA_Name,SWA_WH_Code,SWA_WH_Type,SWA_WH_Address,SWA_ActiveFlag,SWA_CreateDate,SWA_UpdateDate)
      VALUES(#Id#,#DmaId#,#Name#,#WhCode#,#WhType#,#WhAddress#,#ActiveFlag#,#CreateDate:DateTime:1/1/0001 12:00:00 AM#,#UpdateDate:DateTime:1/1/0001 12:00:00 AM#)
    </insert>
    <update id="UpdateSapWarehouseAddress" parameterClass="SapWarehouseAddress">
      UPDATE SAPWarehouseAddress
      SET SWA_ID=#Id#,SWA_DMA_ID=#DmaId#,SWA_Name=#Name#,SWA_WH_Code=#WhCode#,SWA_WH_Type=#WhType#,SWA_WH_Address=#WhAddress#,SWA_ActiveFlag=#ActiveFlag#,SWA_UpdateDate=#UpdateDate#
      WHERE SWA_ID = #Id#
    </update>
    <delete id="DeleteSapWarehouseAddress" parameterClass="string">
      DELETE FROM SAPWarehouseAddress
      WHERE SWA_ID = #value#
    </delete>

    <select id="QuerySapWarehouseAddressByDmaID" parameterClass="System.Collections.Hashtable" resultClass="SapWarehouseAddress">
      SELECT SWA_ID AS Id,SWA_DMA_ID AS DmaId,SWA_Name AS Name,SWA_WH_Code AS WhCode,SWA_WH_Type AS WhType,SWA_WH_Address+'('+ISNULL(SWA_WH_Code,'')+ISNULL(SWA_AddressType,'')+')' AS WhAddress,SWA_ActiveFlag AS ActiveFlag,SWA_CreateDate AS CreateDate,SWA_UpdateDate AS UpdateDate
      ,ROW_NUMBER() OVER (ORDER BY SWA_IsSendAddress DESC) AS [ROW_NUMBER]
      FROM SAPWarehouseAddress
      WHERE SWA_DMA_ID = #DmaId# AND SWA_ActiveFlag=1
    </select>
  </statements>
</sqlMap>
