<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="DpStatementCashflowMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="DpStatementCashflow" assembly="DMS.Model.dll" type="DMS.Model.DpStatementCashflow" />
  </alias>
  <resultMaps>
    <resultMap id="DpStatementCashflowResult" class="DpStatementCashflow">
      <result property="Id" column="STC_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="SthId" column="STC_STH_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="Key" column="STC_Key" type="string" dbType="nvarchar"/>
      <result property="Value" column="STC_Value" type="string" dbType="nvarchar"/>
    </resultMap>
  </resultMaps>
  <statements>

    <select id="SelectDpStatementCashflow" parameterClass="string" resultClass="DpStatementCashflow">
      SELECT STC_ID AS Id,STC_STH_ID AS SthId,STC_Key  AS [Key],STC_Value AS Value
      FROM DPStatementCashflow
      <dynamic prepend="WHERE">
        <isParameterPresent>
          STC_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterDpStatementCashflow" parameterClass="DpStatementCashflow" resultClass="DpStatementCashflow">
      SELECT STC_ID AS Id,STC_STH_ID AS SthId,STC_Key  AS [Key],STC_Value AS Value
      FROM DPStatementCashflow
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">STC_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="SthId">STC_STH_ID=#SthId#</isNotNull>
        <isNotNull prepend="AND" property="Key">STC_Key=#Key#</isNotNull>
        <isNotNull prepend="AND" property="Value">STC_Value=#Value#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertDpStatementCashflow" parameterClass="DpStatementCashflow">
      INSERT INTO DPStatementCashflow
      (STC_ID,STC_STH_ID,STC_Key,STC_Value)
      VALUES(#Id#,#SthId#,#Key#,#Value#)
    </insert>
    <update id="UpdateDpStatementCashflow" parameterClass="DpStatementCashflow">
      UPDATE DPStatementCashflow
      SET STC_ID=#Id#,STC_STH_ID=#SthId#,STC_Key=#Key#,STC_Value=#Value#
      WHERE STC_ID = #Id#
    </update>
    <delete id="DeleteDpStatementCashflow" parameterClass="string">
      DELETE FROM DPStatementCashflow
      WHERE STC_ID = #value#
    </delete>
    
    <!--added by bozhenfei on 20151211-->
    <delete id="DeleteDpStatementCashflowByHeaderId" parameterClass="string">
      DELETE FROM DPStatementCashflow
      WHERE STC_STH_ID = #value#
    </delete>

    <select id="SelectDealerFinanceStatementCashFlowByDealer" parameterClass="System.Collections.Hashtable" resultClass="DpStatementCashflow">
      SELECT STC_ID AS Id,STC_STH_ID AS SthId,STC_Key  AS [Key],STC_Value AS Value
      FROM DPStatementCashflow
      INNER JOIN DPStatementHeader ON STH_ID = STC_STH_ID
      WHERE STH_DMA_ID = #DealerId#
      AND STH_Year + STH_Month = #YearMonth#
    </select>
    <!--end-->
  </statements>
</sqlMap>
