<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="Lafite.IdentityMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <statements>
    <select id="Lafite.IdentityMap.SelectUserName" parameterClass="Guid" resultClass="String">
      <![CDATA[
        SELECT IDENTITY_NAME
        FROM   Lafite_IDENTITY
        WHERE  Id = #value#
      ]]>
    </select>
    <select id="Lafite.IdentityMap.SelectByMobile" parameterClass="String" resultClass="System.Collections.Hashtable">
      <![CDATA[
           SELECT t1.IDENTITY_CODE Account,
               (CASE ISNULL(t2.DMA_ChineseShortName,'') WHEN '' THEN '' ELSE ISNULL(t2.DMA_ChineseShortName,'')+'-' END)+T1.IDENTITY_NAME DealerName
        FROM   Lafite_IDENTITY t1
               left join DealerMaster t2  on  t1.Corp_ID = t2.DMA_ID
        WHERE  PHONE = #value#
               AND ISNULL(PHONE,'')<>''
               AND t1.BOOLEAN_FLAG = 1
               AND t1.DELETE_FLAG = 0
        ORDER BY
               ISNULL(t2.DMA_ChineseShortName,t1.IDENTITY_NAME)
      ]]>
    </select>
  </statements>
</sqlMap>
