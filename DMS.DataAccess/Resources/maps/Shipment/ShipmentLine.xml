<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="ShipmentLineMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="ShipmentLine" assembly="DMS.Model.dll" type="DMS.Model.ShipmentLine" />
  </alias>
  <resultMaps>
    <resultMap id="ShipmentLineResult" class="ShipmentLine">
      <result property="Id" column="SPL_ID" type="Guid" dbType="Guid"/>
      <result property="SphId" column="SPL_SPH_ID" type="Guid" dbType="Guid"/>
      <result property="ShipmentPmaId" column="SPL_Shipment_PMA_ID" type="Guid" dbType="Guid"/>
      <result property="ShipmentQty" column="SPL_ShipmentQty" type="double" dbType="Real"/>
      <result property="UnitPrice" column="SPL_UnitPrice" type="double" dbType="Real"/>
      <result property="LineNbr" column="SPL_LineNbr" type="int" dbType="Int"/>
    </resultMap>
  </resultMaps>
  <parameterMaps>
    <parameterMap id="DeleteShipmentNotAuthCfnParameterMap" class="System.Collections.Hashtable" >
      <parameter property="ShipmentId" column="ShipmentId" />
      <parameter property="ShipmentType" column="ShipmentType" />
      <parameter property="DealerId" column="DealerId" />
      <parameter property="ProductLineId" column="ProductLineId" />
      <parameter property="HospitalId" column="HospitalId" />
      <parameter property="ShipmentDate" column="ShipmentDate" />
      <parameter property="retMassage" column="retMassage" direction="Output" />
    </parameterMap>
  </parameterMaps>
  <statements>

    <select id="SelectShipmentLine" parameterClass="string" resultClass="ShipmentLine">
      SELECT SPL_ID AS Id,SPL_SPH_ID AS SphId,SPL_Shipment_PMA_ID AS ShipmentPmaId,SPL_ShipmentQty AS ShipmentQty,SPL_UnitPrice AS UnitPrice,SPL_LineNbr AS LineNbr
      FROM ShipmentLine
      <dynamic prepend="WHERE">
        <isParameterPresent>
          SPL_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterShipmentLine" parameterClass="ShipmentLine" resultClass="ShipmentLine">
      SELECT SPL_ID AS Id,SPL_SPH_ID AS SphId,SPL_Shipment_PMA_ID AS ShipmentPmaId,SPL_ShipmentQty AS ShipmentQty,SPL_UnitPrice AS UnitPrice,SPL_LineNbr AS LineNbr
      FROM ShipmentLine
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">SPL_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="SphId">SPL_SPH_ID=#SphId#</isNotNull>
        <isNotNull prepend="AND" property="ShipmentPmaId">SPL_Shipment_PMA_ID=#ShipmentPmaId#</isNotNull>
        <isNotNull prepend="AND" property="ShipmentQty">SPL_ShipmentQty=#ShipmentQty#</isNotNull>
        <isNotNull prepend="AND" property="UnitPrice">SPL_UnitPrice=#UnitPrice#</isNotNull>
        <isNotNull prepend="AND" property="LineNbr">SPL_LineNbr=#LineNbr#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertShipmentLine" parameterClass="ShipmentLine">
      INSERT INTO ShipmentLine
      (SPL_ID,SPL_SPH_ID,SPL_Shipment_PMA_ID,SPL_ShipmentQty,SPL_UnitPrice,SPL_LineNbr)
      VALUES(#Id#,#SphId#,#ShipmentPmaId#,#ShipmentQty#,#UnitPrice#,#LineNbr#)
    </insert>
    <update id="UpdateShipmentLine" parameterClass="ShipmentLine">
      UPDATE ShipmentLine
      SET SPL_ID=#Id#,SPL_SPH_ID=#SphId#,SPL_Shipment_PMA_ID=#ShipmentPmaId#,SPL_ShipmentQty=#ShipmentQty#,SPL_UnitPrice=#UnitPrice#,SPL_LineNbr=#LineNbr#
      WHERE SPL_ID = #Id#
    </update>
    <delete id="DeleteShipmentLine" parameterClass="string">
      DELETE FROM ShipmentLine
      WHERE SPL_ID = #value#
    </delete>
    //added by bozhenfei on 20090814
    <delete id="DeleteShipmentLineByHeaderId" parameterClass="string">
      DELETE FROM ShipmentLine
      WHERE SPL_SPH_ID = #value#
    </delete>

    <select id="SelectShipmentLineByHashtable" parameterClass="System.Collections.Hashtable" resultClass="ShipmentLine">
      SELECT SPL_ID AS Id,SPL_SPH_ID AS SphId,SPL_Shipment_PMA_ID AS ShipmentPmaId,SPL_ShipmentQty AS ShipmentQty,SPL_UnitPrice AS UnitPrice,SPL_LineNbr AS LineNbr
      FROM ShipmentLine
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">SPL_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="SphId">SPL_SPH_ID=#SphId#</isNotNull>
        <isNotNull prepend="AND" property="ShipmentPmaId">SPL_Shipment_PMA_ID=#ShipmentPmaId#</isNotNull>
        <isNotNull prepend="AND" property="ShipmentQty">SPL_ShipmentQty=#ShipmentQty#</isNotNull>
        <isNotNull prepend="AND" property="UnitPrice">SPL_UnitPrice=#UnitPrice#</isNotNull>
        <isNotNull prepend="AND" property="LineNbr">SPL_LineNbr=#LineNbr#</isNotNull>
      </dynamic>
    </select>
    <procedure id="GC_DeleteShipmentNotAuthCfn" parameterMap="DeleteShipmentNotAuthCfnParameterMap">
      dbo.GC_ShipmentDetial_ChangeHospital
    </procedure>
  </statements>
</sqlMap>
