<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="ShortMessageQueueMap" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">
  <alias>
    <typeAlias alias="ShortMessageQueue" assembly="DMS.Model.dll" type="DMS.Model.ShortMessageQueue" />
    <typeAlias alias="MessageTaskSend" assembly="DMS.Model.dll" type="DMS.Model.MessageTaskSend" />
  </alias>
  <resultMaps>
    <resultMap id="ShortMessageQueueResult" class="ShortMessageQueue">
      <result property="Id" column="SMQ_ID" type="Guid" dbType="uniqueidentifier"/>
      <result property="QueueNo" column="SMQ_QueueNo" type="string" dbType="nvarchar"/>
      <result property="To" column="SMQ_To" type="string" dbType="nvarchar"/>
      <result property="Message" column="SMQ_Message" type="string" dbType="nvarchar"/>
      <result property="Status" column="SMQ_Status" type="string" dbType="nvarchar"/>
      <result property="CreateDate" column="SMQ_CreateDate" type="DateTime" dbType="datetime"/>
      <result property="SendDate" column="SMQ_SendDate" type="DateTime" dbType="datetime"/>
    </resultMap>
    <resultMap id="MessageTaskSendResult" class="MessageTaskSend">
      <result property="SendMode" column="SendMode" type="string" dbType="nvarchar"/>
      <result property="UserAccount" column="UserAccount" type="string" dbType="nvarchar"/>
      <result property="Email" column="Email" type="string" dbType="nvarchar"/>
      <result property="CC" column="CC" type="string" dbType="nvarchar"/>
      <result property="EmailWechatSubject" column="EmailWechatSubject" type="string" dbType="nvarchar"/>
      <result property="EmailWechatContent" column="EmailWechatContent" type="string" dbType="nvarchar"/>
      <result property="MsgPhone" column="MsgPhone" type="string" dbType="nvarchar"/>
      <result property="MsgTaskID" column="MsgTaskID" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_1" column="AttachmentID_1" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_2" column="AttachmentID_2" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_3" column="AttachmentID_3" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_4" column="AttachmentID_4" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_5" column="AttachmentID_5" type="string" dbType="nvarchar"/>
      <result property="AttachmentID_6" column="AttachmentID_6" type="string" dbType="nvarchar"/>
      <result property="Parameter_1" column="Parameter_1" type="string" dbType="nvarchar"/>
      <result property="Parameter_2" column="Parameter_2" type="string" dbType="nvarchar"/>
      <result property="Parameter_3" column="Parameter_3" type="string" dbType="nvarchar"/>
      <result property="Parameter_4" column="Parameter_4" type="string" dbType="nvarchar"/>
      <result property="Parameter_5" column="Parameter_5" type="string" dbType="nvarchar"/>
      <result property="Parameter_6" column="Parameter_6" type="string" dbType="nvarchar"/>
      <result property="HtmlTranslationFLG" column="HtmlTranslationFLG" type="string" dbType="nvarchar"/>
      <result property="InsertQueFLG" column="InsertQueFLG" type="string" dbType="nvarchar"/>
      <result property="SendAdminFLG" column="SendAdminFLG" type="string" dbType="nvarchar"/>
      <result property="InsertQueStatus" column="InsertQueStatus" type="string" dbType="nvarchar"/>
      <result property="InsertTime" column="InsertTime" type="DateTime" dbType="datetime"/>
      <result property="InsertOrigin" column="InsertOrigin" type="string" dbType="nvarchar"/>
      <result property="GUID" column="GUID" type="string" dbType="nvarchar"/>
    </resultMap>
  </resultMaps>
  <statements>
    <select id="SelectShortMessageQueue" parameterClass="string" resultClass="ShortMessageQueue">
      SELECT SMQ_ID AS Id,SMQ_QueueNo AS QueueNo,SMQ_To AS To,SMQ_Message AS Message,SMQ_Status AS Status,SMQ_CreateDate AS CreateDate,SMQ_SendDate AS SendDate
      FROM ShortMessageQueue
      <dynamic prepend="WHERE">
        <isParameterPresent>
          SMQ_ID = #value#
        </isParameterPresent>
      </dynamic>
    </select>
    <select id="SelectByFilterShortMessageQueue" parameterClass="ShortMessageQueue" resultClass="ShortMessageQueue">
      SELECT SMQ_ID AS Id,SMQ_QueueNo AS QueueNo,SMQ_To AS To,SMQ_Message AS Message,SMQ_Status AS Status,SMQ_CreateDate AS CreateDate,SMQ_SendDate AS SendDate
      FROM ShortMessageQueue
      <dynamic prepend="WHERE">
        <isNotNull prepend="AND" property="Id">SMQ_ID=#Id#</isNotNull>
        <isNotNull prepend="AND" property="QueueNo">SMQ_QueueNo=#QueueNo#</isNotNull>
        <isNotNull prepend="AND" property="To">SMQ_To=#To#</isNotNull>
        <isNotNull prepend="AND" property="Message">SMQ_Message=#Message#</isNotNull>
        <isNotNull prepend="AND" property="Status">SMQ_Status=#Status#</isNotNull>
        <isNotNull prepend="AND" property="SendDate">SMQ_SendDate=#SendDate#</isNotNull>
      </dynamic>
    </select>
    <insert id="InsertShortMessageQueue" parameterClass="ShortMessageQueue">
      INSERT INTO ShortMessageQueue
      (SMQ_ID,SMQ_QueueNo,SMQ_To,SMQ_Message,SMQ_Status,SMQ_CreateDate,SMQ_SendDate)
      VALUES(#Id#,#QueueNo#,#To#,#Message#,#Status#,#CreateDate:DateTime:1/1/0001 12:00:00 AM#,#SendDate:DateTime:1/1/0001 12:00:00 AM#)
    </insert>
    <update id="UpdateShortMessageQueue" parameterClass="ShortMessageQueue">
      UPDATE ShortMessageQueue
      SET SMQ_ID=#Id#,SMQ_QueueNo=#QueueNo#,SMQ_To=#To#,SMQ_Message=#Message#,SMQ_Status=#Status#,SMQ_SendDate=#SendDate#
      WHERE SMQ_ID = #Id#
    </update>
    <delete id="DeleteShortMessageQueue" parameterClass="string">
      DELETE FROM ShortMessageQueue
      WHERE SMQ_ID = #value#
    </delete>
    <!--added by bozhenfei on 20110402-->
    <select id="GetShortMessageQueue" parameterClass="string" resultClass="ShortMessageQueue">
      SELECT SMQ_ID AS Id,SMQ_QueueNo AS QueueNo,SMQ_To AS [To],SMQ_Message AS Message,SMQ_Status AS Status,SMQ_CreateDate AS CreateDate,SMQ_SendDate AS SendDate
      FROM ShortMessageQueue WHERE SMQ_Status = 'Waiting' ORDER BY SMQ_QueueNo,SMQ_CreateDate
    </select>
    <!--end-->

    <insert id="InsertShortMessageTask" parameterClass="MessageTaskSend">
      INSERT INTO SM_SendMessage_TaskQueue_New
      (SendMode,	UserAccount,	Email,	CC,	EmailWechatSubject,	EmailWechatContent,	MsgPhone,	MsgTaskID,	AttachmentID_1,	AttachmentID_2,	AttachmentID_3,	AttachmentID_4,	AttachmentID_5,	AttachmentID_6,	Parameter_1,	Parameter_2,	Parameter_3,	Parameter_4,	Parameter_5,	Parameter_6,	HtmlTranslationFLG,	InsertQueFLG,	SendAdminFLG,	InsertQueStatus,	InsertTime,	InsertOrigin,	GUID)
      VALUES(#SendMode#,	#UserAccount#,	#Email#,	#CC#,	#EmailWechatSubject#,	#EmailWechatContent#,	#MsgPhone#,	#MsgTaskID#,	#AttachmentID_1#,	#AttachmentID_2#,	#AttachmentID_3#,	#AttachmentID_4#,	#AttachmentID_5#,	#AttachmentID_6#,	#Parameter_1#,	#Parameter_2#,	#Parameter_3#,	#Parameter_4#,	#Parameter_5#,	#Parameter_6#,	#HtmlTranslationFLG#,	#InsertQueFLG#,	#SendAdminFLG#,	#InsertQueStatus#,	#InsertTime:DateTime:1/1/0001 12:00:00 AM#,	#InsertOrigin#,	#GUID#)
    </insert>
  </statements>
</sqlMap>
